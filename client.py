import socket
import random

def сonnecting_to_server(client, ip):
    try:
        client.connect((ip, 8080))
    except ConnectionRefusedError:
        print("[ERROR] Сервер не запущен.")
        return 0
    else:
        print("[INFO] Подключение установлено")
        return 1

def main(ip):
    client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    if сonnecting_to_server(client, ip):
        while True:
            try:
                client.send(input("~$ ").encode("utf-8"))
                data = client.recv(1024)
                try:
                    print(data.decode("utf-8"))
                except UnicodeDecodeError:
                    print("[ERROR] utf-8 не может закодировать какой-то байт")
            except KeyboardInterrupt:
                code = random.randint(1, 10)
                print(f"[WARNING]Первым следует выключать сервер.(Создать файл 'a')\nCode: {code}")
                inp = int(input(">"))
                if inp == code:
                    return 0
                    
if __name__ == "__main__":
    IP = "192.168.0.171"
    main(IP)
            
    